
  <section class="no-padding">

    <body>
<form>


<div class="container-fluid" style="padding-top:15px; text-align:right; padding-bottom:5px;">
<div>
  <%= form_tag(jam_sessions_path, :method => "get", id: "jam-search") do %>
  <div class="col-md-2" style="text-align:left;">

 <div class="input-group">
  <span class="input-group-addon">
      <i class="glyphicon glyphicon-map-marker" aria-hidden="true"></i>
</span>
  <%= text_field_tag :name_search, params[:name_search],:id=>"name-search", placeholder: "Search Address    " , class: 'form-control'%>


</div>

<%=link_to "Reset Filters", :onclick=>"ClearFields();", :style=>"text-align:left;"%>
</div>
<div class="col-md-1" style="text-align:center;">
    <%= range_field_tag "Radius", params[:name_search],:id=>"name-search", placeholder: "+- Radius    ", class: 'form-control' %>

</div>
  <div class="col-md-2">
    <div class="input-group">
     <span class="input-group-addon">
         <i class="glyphicon glyphicon-search" aria-hidden="true"></i>
   </span>
  <%= text_field_tag :name_search, params[:name_search],:id=>"name-search", placeholder: "Search Name, Description   ", class: 'form-control' %>
</div>
</div>
<div class="col-md-2">
  <div class="input-group">
   <span class="input-group-addon">
       <i class="glyphicon glyphicon-user" aria-hidden="true"></i>
 </span>

    <%= text_field_tag :host_search, params[:host_search], :id=>"host", placeholder: "Search Host   " , class: 'form-control'%>
</div>
</div>
<div class="col-md-2">
  <div class="input-group">
   <span class="input-group-addon">
       <i class="glyphicon glyphicon-music" aria-hidden="true"></i>
 </span>
    <%= select_tag(:genre_search, options_for_select([['Pop', 'pop'], ['Rock', 'rock'],["Jazz","jazz"],["Soul","soul"],["Metal","metal"],["House","house"],["Classical","classical"]]),:include_blank=>"Any Genre", id:"genre", :class => 'form-control') %>
</div>
</div>
<div class="col-md-2">
  <div class="input-group">
   <span class="input-group-addon">
       <i class="glyphicon glyphicon-time" aria-hidden="true"></i>
 </span>
    <%= select_tag(:time_search, options_for_select([['Now', 1], ['Next 3 Hours', 2],["Next 12 Hours",3],["Next 24 Hours ",4]]),:include_blank=>"Any Time", id:"time",:class => 'form-control') %>
  </div>
</div>
  <div class="col-md-1" style="text-align:center;">

    <%= submit_tag "Search", :name => nil,class:'btn btn-primary btn-s page-scroll', style: 'width:100%; height:100%;'%>
</div>
</div>
<div style="text-align:left;">

</div>
<span class="pull-right">
    </span>
  <% end %>
  <script>
  function ClearFields() {
       document.getElementById("host").value = "";
       document.getElementById("name").value = "";
       document.getElementById("genre").value = "";
       document.getElementById("time").value = "";
  }
  </script>
</div>
</form>
        <div class="container-fluid" style="border:1px solid #cecece;padding:10px ">

        <div class="col-md-6"  style="">
          <div class="row" style="height: 770px; overflow-y:scroll;  padding-right:10px;">
            <!-- Nav tabs -->
            <ul class="nav nav-tabs nav-justified" role="tablist">
              <li role="presentation" class="active">
                <a href="#individual" class="nav-font" aria-controls="individual" role="tab" data-toggle="tab">Jam Sessions</a>
              </li>
              <li role="presentation">
                <a href="#company" class="nav-font" aria-controls="company" role="tab" data-toggle="tab">Your Sessions</a>
              </li>
            </ul>

            <!-- Tab panes -->
            <div class="tab-content" >
              <div role="tabpanel" class="tab-pane active" id="individual" style="padding:30px;">

                <%= render(
                  partial: 'jam_sessions/list',
                  locals: { jam_sessions: @jam_sessions },

                ) %>



              </div>
              <div role="tabpanel" class="tab-pane" id="company" style="margin:30px;">
                <%= render(
                      partial: 'jam_sessions/yoursessions',
                      locals: { jam_sessions: @jam_sessions }
                    )%>

              </div>
            </div>
          </div>
<div class="row" style="text-align:center; float:bottom;padding-left:0px; padding-top:30px;">

    <%= link_to '
    Schedule A Session'.html_safe, "#modal-to-create-jam_session", "data-toggle" => "modal",  :html => { :onclick => "setStart(1);" },class: 'btn btn-primary btn-xl page-scroll', style:'width:69%;height:100%;' %>
      <%= link_to 'Find Chords', "#modal-for-tab-index", "data-toggle" => "modal", class: 'btn btn-primary btn-xl page-scroll', style:'width:30%; height:100%' %>
        </div>
        </div>




        <div class="col-md-6" style="color:black;">
        <div id="map" style='width: 100%; height: 850px; min-height: xxx; overflow: hidden; float: right; padding-right: 0px; margin: 0px'></div></div>
      </div>
      <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
      <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>
      <script type="text/javascript">

      var locations = [];
      var links = [];

      <% @jam_sessions.each do |location| %>
        var place = [<%= location.latitude %>, <%= location.longitude %>, "<%= location.name %>" ];
        locations.push(place);
        var link_id =  <%= location.id %>
        links.push(link_id);
      <% end %>

      var sliderA = new Slider("#ex16a", { min: 0, max: 10, value: 0, focus: true });
      var sliderB = new Slider("#ex16b", { min: 0, max: 10, value: [0, 10], focus: true });

        function initMap(){
            var map = new google.maps.Map(document.getElementById('map'), {
              zoom: 13,
              center: new google.maps.LatLng(42.37, -71.2),
              mapTypeId: google.maps.MapTypeId.ROADMAP
            });

            if (navigator.geolocation) {
                      navigator.geolocation.getCurrentPosition(function(position) {
                        var pos = {
                          lat: position.coords.latitude,
                          lng: position.coords.longitude
                        };
                        var userMarker = new google.maps.Marker({
                          map: map,
                          icon: 'http://www.robotwoods.com/dev/misc/bluecircle.png'
                       });

                        userMarker.setPosition(pos);
                        map.setCenter(pos);

                      }, function() {
                        handleLocationError(true, userMarker, map.getCenter());
                      });
                    } else {
                      // Browser doesn't support Geolocation
                      handleLocationError(false, userMarker, map.getCenter());
                    }


                  function handleLocationError(browserHasGeolocation, infoWindow, pos) {
                    userMarker.setPosition(pos);
                  }




            var marker, i;

            for (i = 0; i < locations.length; i++) {
              marker = new google.maps.Marker({
                position: new google.maps.LatLng(locations[i][0], locations[i][1]),
                map: map,
                name: locations[i][2],
             });
             var boxText =  document.createElement("div");
             var desiredLink = "#modal-for-jam_session\\:" + links[i];
             var desiredText = locations[i][2];
             boxText.innerHTML = '<a data-toggle="modal" href="' + desiredLink + '">' + desiredText + '</a>';
             attachInfowindow(marker, boxText);
           }


           function attachInfowindow(marker, boxText) {
            var infowindow = new google.maps.InfoWindow({
             content: boxText
            });

            marker.addListener('click', function() {
              infowindow.open(marker.get('map'), marker);
            });

          }
        }




      </script>
      <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD_E9YsDaw5Jfj1HC4WKNjepV_maFzCVAQ&callback=initMap"
      type="text/javascript"></script>
      <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAInBNgFEevL4cvtIpxiX0A5gYj7ILlzJc&callback=initMap">
    </script>


      <script src="//maps.google.com/maps/api/js?v=3.13&amp;sensor=false&amp;libraries=geometry" type="text/javascript"></script>
      <script src='//google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.14/src/markerclusterer_packed.js' type='text/javascript'></script>
      <%= javascript_include_tag "application", "data-turbolinks-track" => true %>

      <%= yield :javascripts %>
    </body>

  </section>
<%= render 'jam_sessions/tabs_index_modal'%>
<%@jam_sessions.each do |jam_session|%>
  <%= render 'jam_sessions/jam_modal', jam_session: jam_session %>
<% end %>

<%= render 'jam_sessions/create_jam_modal' %>

<%= render 'jam_sessions/tabs_index_modal'%>

<%= render 'users/edit_modal' %>
